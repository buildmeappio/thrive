
model TemplateVersion {
  id                  String                @id @default(uuid()) @db.Uuid
  templateId          String                @map("template_id") @db.Uuid
  version             Int                   @map("version")
  status              TemplateVersionStatus @default(DRAFT) @map("status")
  locale              String                @default("en-CA") @map("locale") @db.VarChar(10)
  bodyHtml            String                @map("body_html") @db.Text
  variablesSchema     Json                  @map("variables_schema")
  defaultData         Json                  @default("{}") @map("default_data")
  changeNotes         String?               @map("change_notes") @db.Text
  previewPdfS3Key     String?               @map("preview_pdf_s3_key") @db.VarChar(500)
  checksumSha256      String                @map("checksum_sha256") @db.VarChar(64)
  googleDocTemplateId String?               @map("google_doc_template_id") @db.VarChar(255)
  googleDocFolderId   String?               @map("google_doc_folder_id") @db.VarChar(255)
  headerConfig        Json?                 @map("header_config")
  footerConfig        Json?                 @map("footer_config")
  createdBy           String                @map("created_by") @db.Uuid
  createdAt           DateTime              @default(now()) @map("created_at") @db.Timestamptz()

  template        DocumentTemplate  @relation("TemplateVersions", fields: [templateId], references: [id], onDelete: Cascade)
  contracts       Contract[]        @relation("VersionContracts")
  currentTemplate DocumentTemplate? @relation("CurrentTemplateVersion")

  @@unique([templateId, version])
  @@index([templateId])
  @@index([googleDocTemplateId])
  @@map("template_versions")
}