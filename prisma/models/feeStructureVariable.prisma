model FeeStructureVariable {
  id             String          @id @default(uuid()) @db.Uuid
  feeStructureId String          @map("fee_structure_id") @db.Uuid
  label          String          @db.VarChar(80)
  key            String          @db.VarChar(64)
  type           FeeVariableType
  defaultValue   Json?           @map("default_value")
  required       Boolean         @default(false)
  currency       String?         @db.VarChar(3)
  decimals       Int?
  unit           String?         @db.VarChar(20)
  included       Boolean         @default(false)
  sortOrder      Int             @default(0) @map("sort_order")
  createdAt      DateTime        @default(now()) @map("created_at") @db.Timestamptz()
  updatedAt      DateTime        @updatedAt @map("updated_at") @db.Timestamptz()

  // Composite variable fields
  composite    Boolean @default(false)
  subFields    Json?   @map("sub_fields") // Array of SubField: { key, label, type, defaultValue?, required?, unit? }
  referenceKey String? @map("reference_key") @db.VarChar(64) // Key of another variable for percentage calculations

  feeStructure FeeStructure @relation("FeeStructureVariables", fields: [feeStructureId], references: [id], onDelete: Cascade)

  @@unique([feeStructureId, key])
  @@index([feeStructureId])
  @@map("fee_structure_variables")
}

